# Reflex Framework Justfile (using uv)

# Default recipe to display help
default:
    @just --list

# Install dependencies using uv
install:
    uv sync

# Initialize a new Reflex app
init app_name:
    uv run reflex init --name {{app_name}}

# Initialize a new Reflex app with a template
init-template app_name template:
    uv run reflex init --name {{app_name}} --template {{template}}

# Run the Reflex development server
run:
    uv run reflex run

# Run Reflex in production mode
run-prod:
    uv run reflex run --env prod

# Run Reflex on a specific port
run-port port:
    uv run reflex run --port {{port}}

# Run Reflex with frontend only
run-frontend:
    uv run reflex run --frontend-only

# Run Reflex with backend only
run-backend:
    uv run reflex run --backend-only

# Export the app as a static site
export:
    uv run reflex export

# Clean build artifacts and cache
clean:
    rm -rf .web
    rm -rf __pycache__
    find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true
    find . -type f -name "*.pyc" -delete

# Database migration - create new migration
db-migrate message:
    uv run reflex db migrate -m "{{message}}"

# Database migration - upgrade to latest
db-upgrade:
    uv run reflex db upgrade

# Database migration - downgrade one revision
db-downgrade:
    uv run reflex db downgrade

# Login to Reflex hosting
login:
    uv run reflex login

# Deploy to Reflex hosting
deploy:
    uv run reflex deploy

# Run linting with ruff (if available)
lint:
    uv run ruff check .

# Format code with ruff (if available)
format:
    uv run ruff format .

# Add a new dependency
add package:
    uv add {{package}}

# Add a development dependency
add-dev package:
    uv add --dev {{package}}

# Update all dependencies
update:
    uv sync --upgrade

# Run the app with hot reload (alias for run)
dev: run

# Full setup: install dependencies and run
setup: install run
